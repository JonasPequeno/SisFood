CREATE TABLE Usuario(
 Id SERIAL,
 Nome VARCHAR(100) NOT NULL,
 Sexo VARCHAR(1),
 Email VARCHAR(100) PRIMARY KEY,
 Foto VARCHAR(100) NOT NULL,
 Fone VARCHAR(25),
 Descricao VARCHAR(100),
 Profissao VARCHAR(50),
 Cidade VARCHAR(50) NOT NULL,
 Estado VARCHAR(50) NOT NULL,
 CEP VARCHAR(10) NOT NULL,
 Rua VARCHAR(50) NOT NULL,
 Senha VARCHAR(50),
 Status BOOLEAN
);

CREATE TABLE Estabelecimento (
 Id SERIAL PRIMARY KEY,
 Nome VARCHAR(50) NOT NULL,
 Nota REAL,
 Foto VARCHAR(100) NOT NULL,
 Fone VARCHAR(25),
 Tipo VARCHAR(50) NOT NULL,
 Funcionamento VARCHAR(100),
 Descricao VARCHAR(100),
 UserAdd VARCHAR(100),
 Cidade VARCHAR(50) NOT NULL,
 Estado VARCHAR(50) NOT NULL,
 CEP VARCHAR(10) NOT NULL,
 Rua VARCHAR(50) NOT NULL,
 Numero INTEGER NOT NULL,

 FOREIGN KEY(UserAdd)REFERENCES Usuario(Email)
);

CREATE TABLE Comida(
 Id SERIAL PRIMARY KEY,
 Nome VARCHAR(50) NOT NULL,
 Nota REAL,
 Descricao VARCHAR(100) NOT NULL,
 Preco REAL NOT NULL
);

CREATE TABLE Amizade(
 EmailUsuarioRemetente VARCHAR(100),
 EmailUsuarioDestinario VARCHAR(100),

 FOREIGN KEY(EmailUsuarioRemetente)REFERENCES Usuario(Email),
 FOREIGN KEY(EmailUsuarioDestinario)REFERENCES Usuario(Email),
 PRIMARY KEY(EmailUsuarioRemetente,EmailUsuarioDestinario)
);

CREATE TABLE AvaliaComida(
 EmailUsuario VARCHAR(100),
 IdComida INTEGER,
 Avaliacao REAL,
 Comentario VARCHAR(50),

 FOREIGN KEY(EmailUsuario)REFERENCES Usuario(Email),
 FOREIGN KEY(IdComida)REFERENCES Comida(Id),
 PRIMARY KEY(EmailUsuario,IdComida)
);

CREATE TABLE AvaliaEstabelecimento(
 EmailUsuario VARCHAR(100),
 IdEstabelecimento INT,
 Avaliacao REAL,
 Comentario VARCHAR(50),

 FOREIGN KEY(EmailUsuario)REFERENCES Usuario(Email),
 FOREIGN KEY(IdEstabelecimento)REFERENCES Estabelecimento(Id),
 PRIMARY KEY(EmailUsuario,IdEstabelecimento)
);

CREATE TABLE DivulgaEstabelecimento(
 IdDivulgacao SERIAL,
 EmailUsuario VARCHAR(100),
 IdEstabelecimento INT,
 
 FOREIGN KEY(EmailUsuario)REFERENCES Usuario(Email),
 FOREIGN KEY(IdEstabelecimento)REFERENCES Estabelecimento(Id),
 PRIMARY KEY(IdDivulgacao,EmailUsuario,IdEstabelecimento)
);

CREATE TABLE MarcaPresenca(
 IdPresenca SERIAL,
 EmailUsuario VARCHAR(100),
 IdEstabelecimento INT,
 
 FOREIGN KEY(EmailUsuario)REFERENCES Usuario(Email),
 FOREIGN KEY(IdEstabelecimento)REFERENCES Estabelecimento(Id),
 PRIMARY KEY(IdPresenca,EmailUsuario,IdEstabelecimento)
);

CREATE TABLE EstabelecimentoTemComida(
 IdComida INT,
 IdEstabelecimento INT,
 
 FOREIGN KEY(IdComida)REFERENCES Comida(Id),
 FOREIGN KEY(IdEstabelecimento)REFERENCES Estabelecimento(Id),
 PRIMARY KEY(IdComida,IdEstabelecimento)
);

CREATE TABLE IndicaComida( 
 IdIndicacao SERIAL,
 EmailIndicado VARCHAR(100),
 EmailIndicacao VARCHAR(100),
 IdEstabelecimento INT,
 
 FOREIGN KEY(IdComida)REFERENCES Comida(Id),
 FOREIGN KEY(IdEstabelecimento)REFERENCES Estabelecimento(Id),
 FOREIGN KEY(EmailIndicado)REFERENCES Usuario(Email),
 FOREIGN KEY(EmailIndicacao)REFERENCES Usuario(Email),
 PRIMARY KEY(IdIndicacao,IdUsuario,IdComida,IdEstabelecimento)
);

CREATE TABLE EnviaMensagem( 
 IdMensagem SERIAL,
 EmailDestinatario VARCHAR(100),
 EmailRemetente VARCHAR(100),

 FOREIGN KEY(EmailRemetente)REFERENCES Usuario(Email),
 FOREIGN KEY(EmailDestinatario)REFERENCES Usuario(Email),
 PRIMARY KEY(IdMensagem,EmailRemetente,EmailDestinatario)
);

