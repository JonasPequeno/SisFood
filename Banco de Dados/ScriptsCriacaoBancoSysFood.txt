CREATE TABLE Usuario(
 Id SERIAL PRIMARY KEY,
 Nome VARCHAR(100) NOT NULL,
 Sexo VARCHAR(1),
 Email VARCHAR(100) UNIQUE,
 Foto VARCHAR(100) NOT NULL,
 Fone VARCHAR(25),
 Descricao VARCHAR(100),
 Profissao VARCHAR(50),
 Cidade VARCHAR(50) NOT NULL,
 Estado VARCHAR(50) NOT NULL,
 CEP VARCHAR(10) NOT NULL,
 Rua VARCHAR(50) NOT NULL,
 Senha VARCHAR(50),
 Status BOOLEAN
);

CREATE TABLE Estabelecimento (
 Id SERIAL PRIMARY KEY,
 Nome VARCHAR(50) NOT NULL,
 Nota REAL,
 Foto VARCHAR(100) NOT NULL,
 Fone VARCHAR(25),
 Tipo VARCHAR(50) NOT NULL,
 Funcionamento VARCHAR(100),
 Descricao VARCHAR(100),
 UserAdd INT,
 Cidade VARCHAR(50) NOT NULL,
 Estado VARCHAR(50) NOT NULL,
 CEP VARCHAR(10) NOT NULL,
 Rua VARCHAR(50) NOT NULL,
 Numero INTEGER NOT NULL,

 FOREIGN KEY(UserAdd)REFERENCES Usuario(ID)
);

CREATE TABLE Comida(
 Id SERIAL PRIMARY KEY,
 Nome VARCHAR(50) NOT NULL,
 Nota REAL,
 Descricao VARCHAR(100) NOT NULL,
 Preco REAL NOT NULL
);

CREATE TABLE Amizade(
 Status boolean ,
 UserRemetente INT,
 UserDestinatario INT,

 FOREIGN KEY(UserRemetente)REFERENCES Usuario(ID),
 FOREIGN KEY(UserDestinatario)REFERENCES Usuario(ID),
 PRIMARY KEY(UserRemetente,UserDestinatario)
);

CREATE TABLE AvaliaComida(
 Usuario INT,
 IdComida INTEGER,
 Avaliacao REAL,
 Comentario VARCHAR(50),

 FOREIGN KEY(Usuario)REFERENCES Usuario(ID),
 FOREIGN KEY(IdComida)REFERENCES Comida(Id),
 PRIMARY KEY(Usuario,IdComida)
);

CREATE TABLE AvaliaEstabelecimento(
 Usuario INT,
 IdEstabelecimento SERIAL,
 Avaliacao REAL,
 Comentario VARCHAR(50),

 FOREIGN KEY(Usuario)REFERENCES Usuario(ID),
 FOREIGN KEY(IdEstabelecimento)REFERENCES Estabelecimento(Id),
 PRIMARY KEY(Usuario,IdEstabelecimento)
);

CREATE TABLE DivulgaEstabelecimento(
 IdDivulgacao SERIAL,
 Usuario INT,
 IdEstabelecimento INT,
 
 FOREIGN KEY(Usuario)REFERENCES Usuario(ID),
 FOREIGN KEY(IdEstabelecimento)REFERENCES Estabelecimento(Id),
 PRIMARY KEY(IdDivulgacao,Usuario,IdEstabelecimento)
);

CREATE TABLE MarcaPresenca(
 IdPresenca SERIAL,
 Usuario INT,
 IdEstabelecimento INT,
 
 FOREIGN KEY(Usuario)REFERENCES Usuario(ID),
 FOREIGN KEY(IdEstabelecimento)REFERENCES Estabelecimento(Id),
 PRIMARY KEY(IdPresenca,Usuario,IdEstabelecimento)
);

CREATE TABLE EstabelecimentoTemComida(
 IdComida INT,
 IdEstabelecimento INT,
 
 FOREIGN KEY(IdComida)REFERENCES Comida(Id),
 FOREIGN KEY(IdEstabelecimento)REFERENCES Estabelecimento(Id),
 PRIMARY KEY(IdComida,IdEstabelecimento)
);

CREATE TABLE IndicaComida( 
 IdIndicacao SERIAL,
 IdComida INT,
 EmailIndicado INT,
 EmailIndicacao INT,
 IdEstabelecimento INT,
 
 FOREIGN KEY(IdComida)REFERENCES Comida(Id),
 FOREIGN KEY(IdEstabelecimento)REFERENCES Estabelecimento(Id),
 FOREIGN KEY(EmailIndicado)REFERENCES Usuario(ID),
 FOREIGN KEY(EmailIndicacao)REFERENCES Usuario(ID),
 PRIMARY KEY(IdIndicacao)
);

CREATE TABLE EnviaMensagem( 
 IdMensagem SERIAL,
 EmailDestinatario INT,
 EmailRemetente INT,

 FOREIGN KEY(EmailRemetente)REFERENCES Usuario(ID),
 FOREIGN KEY(EmailDestinatario)REFERENCES Usuario(ID),
 PRIMARY KEY(IdMensagem,EmailRemetente,EmailDestinatario)
);

create table Seguir (

 id SERIAL PRIMARY KEY,
 status BOOLEAN,
 userRemetente INTEGER NOT NULL,
 userDestinatario INTEGER NOT NULL,

 FOREIGN KEY (userRemetente) REFERENCES Usuario(id),
 FOREIGN KEY (userDestinatario) REFERENCES Usuario(id)
);


